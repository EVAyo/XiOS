

# ä¸€ã€ç»„ä»¶æš—é»‘

```
// é¢œè‰²é€‚é…æš—é»‘
static inline UIColor* QYCColor(UIColor *lightColor, UIColor *darkColor) {
    if (@available(iOS 13.0, *)) {
        return [UIColor colorWithDynamicProvider:^UIColor * _Nonnull(UITraitCollection * _Nonnull trainCollection) {
            if ([trainCollection userInterfaceStyle] == UIUserInterfaceStyleLight) {
                return lightColor;
            }
            else {
                return darkColor;
            }
        }];
    }
    else {
        return lightColor ? lightColor : (darkColor ? darkColor : [UIColor clearColor]);
    }
}

// åå…­è¿›åˆ¶é¢œè‰²
#define HexColor(hex) [UIColor colorWithRed:((hex >> 16) & 0xFF)/255.0 green:((hex >> 8) & 0xFF)/255.0 blue:(hex & 0xFF)/255.0 alpha:1.0]

// åå…­è¿›åˆ¶é¢œè‰²
#define HexColorAlpha(hex, al) [UIColor colorWithRed:((hex >> 16) & 0xFF)/255.0 green:((hex >> 8) & 0xFF)/255.0 blue:(hex & 0xFF)/255.0 alpha:al]
```



ä½¿ç”¨ï¼š

```
QYCColor(HexColor(0xFFFFFF), HexColor(0xC4C4C4));
```



# äºŒã€ç»„ä»¶å›½é™…åŒ–

## 1. åœ¨ Example ä¸­æŸ¥çœ‹ç»„ä»¶æ”¯æŒå›½é™…åŒ–è¯­è¨€

![](media_pod/035.jpg)



## 2. å¯åˆ›å»ºå¤šä¸ªè¯­è¨€

![](media_pod/036.jpg)



## 3. å…ˆåœ¨ä»»æ„ç›®å½•ä¸‹åˆ›å»º `String File` 

![](media_pod/036.jpg)



## 4. å°†åˆ›å»ºå¥½çš„ `String File` æ‹–åŠ¨åˆ° `Assets` ä¸‹

![](media_pod/037.jpg)



## 5. ç»ˆç«¯å‰å¾€Example ç›®å½•ä¸‹ï¼Œæœ¬åœ°æ›´æ–°åº“ `pod install` 

![](media_pod/038.jpg)



![](media_pod/039.jpg)



![](media_pod/040.jpg)



## 6. ç‚¹å‡»`String File` å³ä¾§ `Localize...`æŒ‰é’®

![](media_pod/041.jpg)



## 7. å…ˆéšä¾¿é€‰æ‹©ä¸€ä¸ªè¯­è¨€

![](media_pod/042.jpg)



## 8. å‹¾é€‰å¤šä¸ªè¯­è¨€

![](media_pod/043.jpg)



## 9. å®é™…ç‰©ç†è·¯å¾„ä¸­ï¼Œ`String File` ä¼šå˜æˆä¸¤ä¸ªå¯¹åº”è¯­è¨€çš„æ–‡ä»¶

![](media_pod/044.jpg)



## 10. é‡æ–°æœ¬åœ°åŠ è½½ `pod install`





## 11. åº“ä¸­å¦‚ä½•ä½¿ç”¨ï¼Ÿ

```
#pragma mark - =========== å›½é™…åŒ– ===========

+ (NSString *)localizedString:(NSString *)key {
    
    NSString *language = [[NSLocale preferredLanguages] firstObject];
    if (language.length == 0) {
        return key;
    }
    NSString *fileNamePrefix = @"zh-Hans";
    if([language hasPrefix:@"en"]) {
        fileNamePrefix = @"en";
    }
    NSBundle *tmpBundle = [NSBundle bundleForClass:[self class]];
    NSURL *url = [tmpBundle URLForResource:@"QYCScan" withExtension:@"bundle"];
    if(!url) return key;
    NSBundle *tmp = [NSBundle bundleWithURL:url];
    
    NSString *path = [tmp pathForResource:fileNamePrefix ofType:@"lproj"];
    NSBundle *bundle = [NSBundle bundleWithPath:path];
    NSString *localizedString = [bundle localizedStringForKey:key value:nil table:@"Localizable"];
    if (!localizedString) {
        localizedString = key;
    }
    return localizedString;
}


// è°ƒç”¨
NSString *AA = [QRUtil localizedString:@"æ‰«ä¸€æ‰«"];
```



## 12. æµ‹è¯•æ•°æ®

![](media_pod/045.jpg)



## 13.æˆåŠŸ

![](media_pod/046.jpg)









# ä¸‰ã€ç»„ä»¶æ‰¹é‡å›½é™…åŒ–

è¯­è¨€å›½é™…åŒ–åˆå«åšè¯­è¨€æœ¬åœ°åŒ–ã€‚æœ¬æ–‡ä¸»è¦æ˜¯è®°å½•è‡ªå·±åœ¨åšå›½é™…åŒ–çš„è¿‡ç¨‹ä¸­çš„ä¸€äº›æ³¨æ„ç‚¹å’ŒæŠ€å·§ã€‚

å…·ä½“çš„é…ç½®ç½‘ä¸Šæœ‰ä¸€å †æ•™ç¨‹ï¼Œå°±ä¸å±•å¼€äº†ï¼Œéšä¾¿è´´ä¸€ä¸ª[æ•™ç¨‹](https://cloud.tencent.com/developer/article/1143302)ï¼›

## æ³¨æ„ç‚¹1

ä»£ç éƒ¨åˆ†çš„å›½é™…åŒ–ï¼Œå¤§å¤šæ•°ä½¿ç”¨åˆ°ä¸‹é¢çš„å®æˆ–è€…æ–¹æ³•

```objectivec
NSLocalizedString("è¿™é‡Œæ˜¯éœ€è¦å›½é™…åŒ–çš„å­—ç¬¦",comment: "è¿™é‡Œæ˜¯æ³¨é‡Š")

#define NSLocalizedString(key, comment) \
	    [NSBundle.mainBundle localizedStringForKey:(key) value:@"" table:nil]
    
#define NSLocalizedStringFromTable(key, tbl, comment) \
	    [NSBundle.mainBundle localizedStringForKey:(key) value:@"" table:(tbl)]
    
#define NSLocalizedStringFromTableInBundle(key, tbl, bundle, comment) \
	    [bundle localizedStringForKey:(key) value:@"" table:(tbl)]


    ...
/* Method for retrieving localized strings. */
- (NSString *)localizedStringForKey:(NSString *)key 
                              value:(nullable NSString *)value 
                              table:(nullable NSString *)tableName NS_FORMAT_ARGUMENT(1);
```

è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼Œä¸ç®¡ä½ æ˜¯æ–°è€é¡¹ç›®ï¼›ä½ éƒ½å¯ä»¥ä½¿ç”¨æ­£åˆ™åŒ¹é…æ¥æŸ¥æ‰¾é¡¹ç›®ä¸­æ‰€æœ‰æ²¡æœ‰å›½é™…åŒ–çš„å­—ç¬¦ï¼š

![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647511705666-c23fe15e-e8ea-4c6c-90cd-1b8c4f1cc356.png)

å¦‚å›¾ï¼šä¿®æ”¹é¡¹ç›®æœç´¢ä¸ºæ›¿æ¢ï¼Œé€‰æ‹©æ­£åˆ™åŒ¹é…ï¼Œç„¶åæ·»åŠ 

OC

```objectivec
@"[^"]*[\u4E00-\u9FA5]+[^"\n]*?"

NSLocalizedString($0, nil)
```

Swift

```swift
"[^"]*[\u4E00-\u9FA5]+[^"\n]*?"

NSLocalizedString($0, comment: "")
```

NSLocalizedStringå¯ä»¥ä½¿ç”¨ä½ é¡¹ç›®ä¸­è‡ªå®šä¹‰çš„å®æˆ–è€…å…¶ä»–å‡½æ•°ç­‰



## æ³¨æ„ç‚¹2

å¦ä¸€ç§ç”ŸæˆStrings Fileæ–‡ä»¶çš„æ–¹æ³•ï¼ˆä¸ªäººæ¯”è¾ƒæ¨èï¼‰

**å‰æï¼š** **å½“æ‰€æœ‰çš„.mæ–‡ä»¶éƒ½ä½¿ç”¨****NSLocalizedStringï¼ˆæˆ–è€…æ˜¯è‡ªå®šä¹‰çš„å®æˆ–è€…æ–¹æ³•ï¼‰****ä¿®æ”¹å¥½ä¹‹åï¼Œå°±å¯ä»¥åŠ¨ç”¨****genstrings****å·¥å…·äº†**

1. å¯åŠ¨ç»ˆç«¯ï¼Œè¿›å…¥å·¥ç¨‹æ‰€åœ¨ç›®å½•ã€‚
2. æ–°å»ºéœ€è¦æ”¯æŒçš„è¯­è¨€.lproj æ–‡ä»¶å¤¹ï¼Œä½ç½®é»˜è®¤æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ ç›®å½•åä¼šä½œç”¨åˆ°Localizable.stringsæ–‡ä»¶å¯¹åº”çš„è¯­è¨€ï¼Œæ‰€ä»¥ç›®å½•åç§°ä¸èƒ½å†™é”™äº†ã€‚

```objectivec
//ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºè¯­.lprojæ–‡ä»¶å¤¹ï¼ˆä¸‹é¢ä»¥åˆ›å»ºè‹±æ–‡ä¸ºä¾‹ï¼Œå…¶ä»–è¯­è¨€åŒæ ·æ“ä½œï¼‰
mkdir en.lproj

 // ç¬¬äºŒæ­¥ æŸ¥æ‰¾å¹¶ç”Ÿæˆå¯¹åº”çš„stringsæ–‡ä»¶
 //oc
find ./ -name "*.m" | xargs genstrings -o en.lproj
// swift
find ./ -name "*.swift" | xargs genstrings -o en.lproj

//å®å®šä¹‰æˆ–è€…å¯¹NSLocalizedStringå‡½æ•°è¿›è¡Œäº†å°è£…çš„è¯ï¼Œéœ€è¦åœ¨å‘½ä»¤åé¢æ·»åŠ ä¸Š -s ã€Œå®å®šä¹‰æˆ–è€…å°è£…çš„å‡½æ•°ã€
find ./ -name "*.m" | xargs genstrings -o en.lproj -s QYCLocalizedString
```

3ã€å°†ç”Ÿæˆçš„.Strings æ–‡ä»¶æ•´ç†åˆ°å¯¹åº”çš„ç›®å½•åï¼Œå¯ä»¥æ‹–æ‹½åˆ°é¡¹ç›®ä¸­å»ï¼ˆå°±åƒæ‹–æ‹½OCæ–‡ä»¶ä¸€æ ·ï¼‰ï¼Œç„¶ååœ¨Xcodeå³ä¾§å‹¾é€‰ä¸Šå¯¹åº”çš„è¯­è¨€

#### è¡¥å……

ä¸‹é¢æ˜¯genstringså‘½åçš„åŸºæœ¬è¯­æ³•ï¼š

```
genstrings [-a] [-q] [-o <outputDir>] sourcefile
```

å…¶ä¸­å‚æ•°ï¼š

-a  åœ¨å­˜åœ¨çš„æ–‡ä»¶åé¢è¿½åŠ å†…å®¹

-q  å…³é—­å¤šä¸ªé”®/å€¼å¯¹çš„è­¦å‘Š

-o  æŒ‡å®šè¾“å‡ºç›®å½•

å› æ­¤å¦‚æœæˆ‘ä»¬æƒ³è¾“å‡ºåˆ°en.lprojç›®å½•ï¼Œåˆ™ä»£ç å¦‚ä¸‹ï¼š

```
genstrings -o en.lproj  *.m
```

è¿™æ ·å°±åœ¨en.lprojç›®å½•ä¸‹é¢äº§ç”Ÿäº†Localizable.stringsæ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸Šé¢çš„å‘½ä»¤æ¯æ¬¡è¿è¡Œçš„æ—¶å€™éƒ½ä¼šè¦†ç›–Localizable.stringsæ–‡ä»¶ï¼Œå¦‚æœå†…å®¹ä¸æƒ³è¦†ç›–å¯ä»¥ä½¿ç”¨-aå‚æ•°ï¼Œç„¶ååœ¨æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ã€‚

[
](https://blog.csdn.net/xiaofei125145/article/details/44175379)

## æ³¨æ„ç‚¹3

xibå›½é™…åŒ–ä¹Ÿå¤§æ¦‚æœ‰ä¸‰ç§æ–¹æ¡ˆï¼š

ç¬¬ä¸€ç§æ˜¯å»ºç«‹å¤šå¥—xibï¼Œå„ä¸ªè¯­è¨€å¯¹åº”ä¸€å¥—ï¼Œæ³¨æ„ä»£ç ä¸­å¼•ç”¨å¯¹åº”çš„xibï¼ˆä¸å»ºè®®ï¼‰ï¼›

ç¬¬äºŒç§æ˜¯å°†xibä¸Šçš„å†™æ­»æ–‡å­—çš„æ§ä»¶æ‹–æ‹½è‡³ä»£ç åŒºï¼Œä½¿ç”¨ä»£ç è¿›è¡Œå›½é™…åŒ–ï¼›

ç¬¬ä¸‰ç§å¦‚ä¸‹ï¼š

![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647569194791-040830ee-dcfe-4272-a12d-3cc782078dc6.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647569257015-5d7bde54-a1c4-4325-9111-e75d8eb12871.png)![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647569356309-8992f80e-e2a8-4b25-acac-d6510b076171.png)

è¿™ç§æ–¹å¼æ³¨æ„åœ¨åŠ è½½xibæ—¶çš„ä»£ç ä½¿ç”¨:xibçš„åç§°éœ€è¦å˜ä¸º â€œè¯­è¨€.lproj/xibåç§°â€ï¼š

![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647569816853-1908ee4d-1a65-42e4-a998-697c69564062.png)

è¿˜éœ€è¦æ³¨æ„çš„æ˜¯xibå¢å‡æ–‡å­—æ§ä»¶åï¼Œå¯¹åº”çš„stringsæ–‡ä»¶å†…å®¹ä¸ä¼šä¸»åŠ¨å‘é€å˜åŒ–ï¼Œéœ€è¦è‡ªå·±å»ä¿®æ”¹ï¼Œè¿˜å¥½ï¼ŒXcodeä¸ºæˆ‘ä»¬æä¾›äº†ibtoolå·¥å…·æ¥ç”ŸæˆStoryboardçš„stringsæ–‡ä»¶ã€‚

```objectivec
ibtool [MyNib].xib --generate-strings-file [MyNib_new.strings]
```

ä½†æ˜¯ibtoolç”Ÿæˆçš„stringsæ–‡ä»¶æ˜¯BaseStoryboardçš„strings(é»˜è®¤è¯­è¨€çš„strings)ï¼Œä¸”ä¼šæŠŠæˆ‘ä»¬åŸæ¥çš„stringsæ›¿æ¢æ‰ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠæ–°ç”Ÿæˆçš„stringsä¸æ—§çš„stringsè¿›è¡Œå†²çªå¤„ç†(æ–°çš„é™„åŠ ä¸Šï¼Œåˆ é™¤æ‰çš„æ³¨é‡Šæ‰)ï¼Œè¿™ä¸€åˆ‡å¯ä»¥ç”¨è¿™ä¸ªpythoyè„šæœ¬æ¥å®ç°ï¼Œè§[AutoLocalization](https://github.com/onezens/AutoLocalization)



## æ³¨æ„ç‚¹4



æœ¬åœ°åŒ–å­—ç¬¦ä¸²å‚æ•°é¡ºåºçš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯å¤šå‚æ•°æ—¶ã€‚

ä¸ºäº†ä½¿å¤šè¯­è¨€ä¸­è¯­æ³•é€šé¡ºï¼Œå¿…é¡»è¦æ›´æ”¹å ä½ç¬¦å¯¹åº”çš„å‚æ•°é¡ºåºï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚å¥å­æŒ‰ç…§ä¸­æ–‡è¯­æ³•ç»„ç»‡ï¼Œæ³¨æ„en.lprojä¸­çš„tipå­—æ®µã€‚

æˆ‘ä»¬å¯ä»¥åœ¨%å’Œ@ä¹‹é—´ï¼ŒåŠ ä¸Š1$,2$æ¥æŒ‡å®šå‚æ•°çš„é¡ºåºã€‚é¡ºåºæ˜¯ä»1å¼€å§‹çš„ã€‚

![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647570893676-4c9d19cf-f97e-4097-8477-3205ee402ae3.png)![img](https://cdn.nlark.com/yuque/0/2022/png/1296228/1647570908658-680e5243-f5d0-4a30-ba01-89d074e80d50.png)





## æ³¨æ„ç‚¹5

è„šæœ¬ï¼š

åœ¨ ä½¿ç”¨Xcodeæä¾›çš„æ­£åˆ™æ›¿æ¢äº†é¡¹ç›®çš„æ±‰å­—æ—¶ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æ—¶æ— æ³•ç›´æ¥å…¨éƒ¨æ›¿æ¢çš„ï¼Œè¿™å°±æœ‰å¯èƒ½éƒ¨åˆ†æ²¡æœ‰æ›¿æ¢ï¼ŒåŒæ—¶ç”±äºä¸åŒé¡¹ç›®çš„å†™æ³•ä¸ä¸€æ ·ï¼Œæ­£åˆ™ä¹Ÿä¸ä¸€å®šéƒ½èƒ½è¯†åˆ«å‡ºï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ£€æµ‹è¿˜æœ‰å“ªäº›æœªå›½é™…åŒ–[ğŸ“unLocalizable.py](https://www.yuque.com/attachments/yuque/0/2022/py/1296228/1647571399702-4c737831-d7ea-4fc8-9aa7-232a52360a4d.py)



å›½é™…åŒ–çš„æ—¶å€™éš¾å…ä¼šç”±äºä¸å°å¿ƒï¼Œä¼šå‡ºç°æŸä¸ª .strings æ–‡ä»¶ä¸­å­˜åœ¨æ²¡æœ‰æ·»åŠ çš„å›½é™…åŒ–å­—ç¬¦ä¸²,å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ£€æµ‹[ğŸ“checkLocalizable.py](https://www.yuque.com/attachments/yuque/0/2022/py/1296228/1647571147129-ab2c1351-e708-4dca-b046-a6f29e5714c2.py)



å›½é™…åŒ–çš„æ—¶å€™ä¸å°å¿ƒä¼šå‡ºç°è¯­æ³•é”™è¯¯ï¼Œå¦‚æœå›½é™…åŒ–æ–‡ä»¶æœ‰å‡ åƒè¡Œçš„æ—¶å€™ï¼Œé‚£å°±å°´å°¬äº†ï¼Œæ‰¾æ­»ä½ ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬å®šä½åˆ°æŠ¥é”™çš„ä»£ç è¡Œ[ğŸ“localizableError.py](https://www.yuque.com/attachments/yuque/0/2022/py/1296228/1647571116377-3f583b65-3e90-4637-a642-d65baf7c6d87.py)





















